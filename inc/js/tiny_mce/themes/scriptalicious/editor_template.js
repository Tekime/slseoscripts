(function(g){var j=g.DOM,Event=g.dom.Event,extend=g.extend,each=g.each,Cookie=g.util.Cookie,lastExtID,explode=g.explode;g.ThemeManager.requireLangPack('scriptalicious');g.create('tinymce.themes.ScriptaliciousTheme',{getInfo:function(){return{longname:'Scriptalicious Theme',author:'Scriptalicious',authorurl:'http://www.scriptalicious.com/',version:g.majorVersion+"."+g.minorVersion}},sizes:[8,10,12,14,18,24,36],controls:{bold:['bold_desc','Bold'],italic:['italic_desc','Italic'],underline:['underline_desc','Underline'],strikethrough:['striketrough_desc','Strikethrough'],justifyleft:['justifyleft_desc','JustifyLeft'],justifycenter:['justifycenter_desc','JustifyCenter'],justifyright:['justifyright_desc','JustifyRight'],justifyfull:['justifyfull_desc','JustifyFull'],bullist:['bullist_desc','InsertUnorderedList'],numlist:['numlist_desc','InsertOrderedList'],outdent:['outdent_desc','Outdent'],indent:['indent_desc','Indent'],cut:['cut_desc','Cut'],copy:['copy_desc','Copy'],paste:['paste_desc','Paste'],undo:['undo_desc','Undo'],redo:['redo_desc','Redo'],link:['link_desc','mceLink'],unlink:['unlink_desc','unlink'],image:['image_desc','mceImage'],cleanup:['cleanup_desc','mceCleanup'],help:['help_desc','mceHelp'],code:['code_desc','mceCodeEditor'],hr:['hr_desc','InsertHorizontalRule'],removeformat:['removeformat_desc','RemoveFormat'],sub:['sub_desc','subscript'],sup:['sup_desc','superscript'],forecolor:['forecolor_desc','ForeColor'],forecolorpicker:['forecolor_desc','mceForeColor'],backcolor:['backcolor_desc','HiliteColor'],backcolorpicker:['backcolor_desc','mceBackColor'],charmap:['charmap_desc','mceCharMap'],visualaid:['visualaid_desc','mceToggleVisualAid'],anchor:['anchor_desc','mceInsertAnchor'],newdocument:['newdocument_desc','mceNewDocument'],blockquote:['blockquote_desc','mceBlockQuote']},stateControls:['bold','italic','underline','strikethrough','bullist','numlist','justifyleft','justifycenter','justifyright','justifyfull','sub','sup','blockquote'],init:function(e,f){var t=this,s,v,o;t.editor=e;t.url=f;t.onResolveName=new g.util.Dispatcher(this);t.tabsbar=false;t.settings=s=extend({theme_scriptalicious_path:true,theme_scriptalicious_toolbar_location:'bottom',theme_scriptalicious_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_scriptalicious_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_scriptalicious_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap",theme_scriptalicious_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_scriptalicious_toolbar_align:"center",theme_scriptalicious_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_scriptalicious_more_colors:1,theme_scriptalicious_row_height:23,theme_scriptalicious_resize_horizontal:1,theme_scriptalicious_resizing_use_cookie:1,theme_scriptalicious_font_sizes:"1,2,3,4,5,6,7",theme_scriptalicious_tabs_location:'top',theme_scriptalicious_layout_mode:'editor',editor_source_mode:true,readonly:e.settings.readonly},e.settings);t.tabd={urlon:g.baseURL+'/themes/'+s.theme+'/skins/'+s.skin+'/img/ctrlBtnDesignOn.gif',urloff:g.baseURL+'/themes/'+s.theme+'/skins/'+s.skin+'/img/ctrlBtnDesignOff.gif',title:'Design Mode',id:t.editor.id+'_tab_design'};t.tabs={urlon:g.baseURL+'/themes/'+s.theme+'/skins/'+s.skin+'/img/ctrlBtnSourceOn.gif',urloff:g.baseURL+'/themes/'+s.theme+'/skins/'+s.skin+'/img/ctrlBtnSourceOff.gif',title:'Source Mode',id:t.editor.id+'_tab_source'};e.addCommand('mceSwitchTabs',t._switchTabs,t);e.onPostRender.add(function(){if(e.getParam('morebutton_mode')==1){var a=e.getParam('morebutton_toolbar','toolbar2');g.DOM.hide(e.controlManager.get(a).id)}var a=e.getParam('codemirror_toolbar','toolbar3');if(e.getParam('theme_scriptalicious_layout_mode')=='source'){g.DOM.show(e.controlManager.get(a).id)}else{g.DOM.hide(e.controlManager.get(a).id)}});if(!s.font_size_style_values)s.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt";if(g.is(s.theme_scriptalicious_font_sizes,'string')){s.font_size_style_values=g.explode(s.font_size_style_values);s.font_size_classes=g.explode(s.font_size_classes||'');o={};e.settings.theme_scriptalicious_font_sizes=s.theme_scriptalicious_font_sizes;each(e.getParam('theme_scriptalicious_font_sizes','','hash'),function(v,k){var a;if(k==v&&v>=1&&v<=7){k=v+' ('+t.sizes[v-1]+'pt)';if(e.settings.convert_fonts_to_spans){a=s.font_size_classes[v-1];v=s.font_size_style_values[v-1]||(t.sizes[v-1]+'pt')}}if(/^\s*\./.test(v))a=v.replace(/\./g,'');o[k]=a?{'class':a}:{fontSize:v}});s.theme_scriptalicious_font_sizes=o}if((v=s.theme_scriptalicious_path_location)&&v!='none')s.theme_scriptalicious_statusbar_location=s.theme_scriptalicious_path_location;if(s.theme_scriptalicious_statusbar_location=='none')s.theme_scriptalicious_statusbar_location=0;e.onInit.add(function(){e.onNodeChange.add(t._nodeChanged,t);if(e.settings.content_css!==false)e.dom.loadCSS(e.baseURI.toAbsolute("themes/scriptalicious/skins/"+e.settings.skin+"/content.css"))});e.onSetProgressState.add(function(a,b,c){var d,id=a.id,tb;if(b){t.progressTimer=setTimeout(function(){d=a.getContainer();d=d.insertBefore(j.create('DIV',{style:'position:relative'}),d.firstChild);tb=j.get(a.id+'_tbl');j.add(d,'div',{id:id+'_blocker','class':'mceBlocker',style:{width:tb.clientWidth+2,height:tb.clientHeight+2}});j.add(d,'div',{id:id+'_progress','class':'mceProgress',style:{left:tb.clientWidth/2,top:tb.clientHeight/2}})},c||0)}else{j.remove(id+'_blocker');j.remove(id+'_progress');clearTimeout(t.progressTimer)}});j.loadCSS(s.editor_css?e.documentBaseURI.toAbsolute(s.editor_css):f+"/skins/"+e.settings.skin+"/ui.css");if(s.skin_variant)j.loadCSS(f+"/skins/"+e.settings.skin+"/ui_"+s.skin_variant+".css")},createControl:function(n,a){var b,c;if(c=a.createControl(n))return c;switch(n){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}if((b=this.controls[n]))return a.createButton(n,{title:"scriptalicious."+b[0],cmd:b[1],ui:b[2],value:b[3]})},execCommand:function(a,b,c){var f=this['_'+a];if(f){f.call(this,b,c);return true}return false},_importClasses:function(e){var a=this.editor,c=a.controlManager.get('styleselect');if(c.getLength()==0){each(a.dom.getClasses(),function(o){c.add(o['class'],o['class'])})}},_createStyleSelect:function(n){var t=this,ed=t.editor,cf=ed.controlManager,c=cf.createListBox('styleselect',{title:'scriptalicious.style_select',onselect:function(v){if(c.selectedValue===v){ed.execCommand('mceSetStyleInfo',0,{command:'removeformat'});c.select();return false}else ed.execCommand('mceSetCSSClass',0,v)}});if(c){each(ed.getParam('theme_scriptalicious_styles','','hash'),function(v,k){if(v)c.add(t.editor.translate(k),v)});c.onPostRender.add(function(a,n){if(!c.NativeListBox){Event.add(n.id+'_text','focus',t._importClasses,t);Event.add(n.id+'_text','mousedown',t._importClasses,t);Event.add(n.id+'_open','focus',t._importClasses,t);Event.add(n.id+'_open','mousedown',t._importClasses,t)}else Event.add(n.id,'focus',t._importClasses,t)})}return c},_createFontSelect:function(){var c,t=this,ed=t.editor;c=ed.controlManager.createListBox('fontselect',{title:'scriptalicious.fontdefault',cmd:'FontName'});if(c){each(ed.getParam('theme_scriptalicious_fonts',t.settings.theme_scriptalicious_fonts,'hash'),function(v,k){c.add(ed.translate(k),v,{style:v.indexOf('dings')==-1?'font-family:'+v:''})})}return c},_createFontSizeSelect:function(){var t=this,ed=t.editor,c,i=0,cl=[];c=ed.controlManager.createListBox('fontsizeselect',{title:'scriptalicious.font_size',onselect:function(v){if(v.fontSize)ed.execCommand('FontSize',false,v.fontSize);else{each(t.settings.theme_scriptalicious_font_sizes,function(v,k){if(v['class'])cl.push(v['class'])});ed.editorCommands._applyInlineStyle('span',{'class':v['class']},{check_classes:cl})}}});if(c){each(t.settings.theme_scriptalicious_font_sizes,function(v,k){var a=v.fontSize;if(a>=1&&a<=7)a=t.sizes[parseInt(a)-1]+'pt';c.add(k,v,{'style':'font-size:'+a,'class':'mceFontSize'+(i++)+(' '+(v['class']||''))})})}return c},_createBlockFormats:function(){var c,fmts={p:'scriptalicious.paragraph',address:'scriptalicious.address',pre:'scriptalicious.pre',h1:'scriptalicious.h1',h2:'scriptalicious.h2',h3:'scriptalicious.h3',h4:'scriptalicious.h4',h5:'scriptalicious.h5',h6:'scriptalicious.h6',div:'scriptalicious.div',blockquote:'scriptalicious.blockquote',code:'scriptalicious.code',dt:'scriptalicious.dt',dd:'scriptalicious.dd',samp:'scriptalicious.samp'},t=this;c=t.editor.controlManager.createListBox('formatselect',{title:'scriptalicious.block',cmd:'FormatBlock'});if(c){each(t.editor.getParam('theme_scriptalicious_blockformats',t.settings.theme_scriptalicious_blockformats,'hash'),function(v,k){c.add(t.editor.translate(k!=v?k:fmts[v]),v,{'class':'mce_formatPreview mce_'+v})})}return c},_createForeColorMenu:function(){var c,t=this,s=t.settings,o={},v;if(s.theme_scriptalicious_more_colors){o.more_colors_func=function(){t._mceColorPicker(0,{color:c.value,func:function(a){c.setColor(a)}})}}if(v=s.theme_scriptalicious_text_colors)o.colors=v;if(s.theme_scriptalicious_default_foreground_color)o.default_color=s.theme_scriptalicious_default_foreground_color;o.title='scriptalicious.forecolor_desc';o.cmd='ForeColor';o.scope=this;c=t.editor.controlManager.createColorSplitButton('forecolor',o);return c},_createBackColorMenu:function(){var c,t=this,s=t.settings,o={},v;if(s.theme_scriptalicious_more_colors){o.more_colors_func=function(){t._mceColorPicker(0,{color:c.value,func:function(a){c.setColor(a)}})}}if(v=s.theme_scriptalicious_background_colors)o.colors=v;if(s.theme_scriptalicious_default_background_color)o.default_color=s.theme_scriptalicious_default_background_color;o.title='scriptalicious.backcolor_desc';o.cmd='HiliteColor';o.scope=this;c=t.editor.controlManager.createColorSplitButton('backcolor',o);return c},renderUI:function(o){var n,ic,tb,t=this,ed=t.editor,s=t.settings,sc,p,nl;var a;n=p=j.create('span',{id:ed.id+'_parent','class':'mceEditor '+ed.settings.skin+'Skin'+(s.skin_variant?' '+ed.settings.skin+'Skin'+t._ufirst(s.skin_variant):'')});if(!j.boxModel)n=j.add(n,'div',{'class':'mceOldBoxModel'});if(s.theme_scriptalicious_tabs_location=='top'){t._addTabs(p,o)}n=sc=j.add(n,'table',{id:ed.id+'_tbl','class':'mceLayout',cellSpacing:0,cellPadding:0});n=tb=j.add(n,'tbody');switch((s.theme_scriptalicious_layout_manager||'').toLowerCase()){case"rowlayout":ic=t._rowLayout(s,tb,o);break;case"customlayout":if(s.theme_scriptalicious_layout_mode.toLowerCase()=='source'){ic=t._sourceLayout(s,tb,o,p)}else{ic=t.scriptaliciousLayout(s,tb,o,p)}break;default:ic=t._simpleLayout(s,tb,o,p)}n=o.targetNode;nl=j.stdMode?sc.getElementsByTagName('tr'):sc.rows;j.addClass(nl[0],'mceFirst');j.addClass(nl[nl.length-1],'mceLast');each(j.select('tr',tb),function(n){j.addClass(n.firstChild,'mceFirst');j.addClass(n.childNodes[n.childNodes.length-1],'mceLast')});if(j.get(s.theme_scriptalicious_toolbar_container))j.get(s.theme_scriptalicious_toolbar_container).appendChild(p);else j.insertAfter(p,n);Event.add(ed.id+'_path_row','click',function(e){e=e.target;if(e.nodeName=='A'){t._sel(e.className.replace(/^.*mcePath_([0-9]+).*$/,'$1'));return Event.cancel(e)}});if(!ed.getParam('accessibility_focus'))Event.add(j.add(p,'a',{href:'#'},'<!-- IE -->'),'focus',function(){tinyMCE.get(ed.id).focus()});if(s.theme_scriptalicious_toolbar_location=='external')o.deltaHeight=0;t.deltaHeight=o.deltaHeight;o.targetNode=null;return{iframeContainer:ic,editorContainer:ed.id+'_parent',sizeContainer:sc,deltaHeight:o.deltaHeight}},resizeBy:function(a,b){var e=j.get(this.editor.id+'_tbl');this.resizeTo(e.clientWidth+a,e.clientHeight+b)},resizeTo:function(w,h){var a=this.editor,s=a.settings,e=j.get(a.id+'_tbl'),ifr=j.get(a.id+'_ifr'),dh;w=Math.max(s.theme_scriptalicious_resizing_min_width||100,w);h=Math.max(s.theme_scriptalicious_resizing_min_height||100,h);w=Math.min(s.theme_scriptalicious_resizing_max_width||0xFFFF,w);h=Math.min(s.theme_scriptalicious_resizing_max_height||0xFFFF,h);dh=e.clientHeight-ifr.clientHeight;j.setStyle(ifr,'height',h-dh);j.setStyles(e,{width:w,height:h})},destroy:function(){var a=this.editor.id;Event.clear(a+'_resize');Event.clear(a+'_path_row');Event.clear(a+'_external_close')},_simpleLayout:function(s,a,o,p){var t=this,ed=t.editor,lo=s.theme_scriptalicious_toolbar_location,sl=s.theme_scriptalicious_statusbar_location,n,ic,etb,c;if(s.readonly){n=j.add(a,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'});return ic}if(lo=='top')t._addToolbars(a,o);if(lo=='external'){n=c=j.create('div',{style:'position:relative'});n=j.add(n,'div',{id:ed.id+'_external','class':'mceExternalToolbar'});j.add(n,'a',{id:ed.id+'_external_close',href:'javascript:;','class':'mceExternalClose'});n=j.add(n,'table',{id:ed.id+'_tblext',cellSpacing:0,cellPadding:0});etb=j.add(n,'tbody');if(p.firstChild.className=='mceOldBoxModel')p.firstChild.appendChild(c);else p.insertBefore(c,p.firstChild);t._addToolbars(etb,o);ed.onMouseUp.add(function(){var e=j.get(ed.id+'_external');j.show(e);j.hide(lastExtID);var f=Event.add(ed.id+'_external_close','click',function(){j.hide(ed.id+'_external');Event.remove(ed.id+'_external_close','click',f)});j.show(e);j.setStyle(e,'top',0-j.getRect(ed.id+'_tblext').h-1);j.hide(e);j.show(e);e.style.filter='';lastExtID=ed.id+'_external';e=null})}if(sl=='top')t._addStatusBar(a,o);if(!s.theme_scriptalicious_toolbar_container){n=j.add(a,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'})}if(lo=='bottom')t._addToolbars(a,o);if(sl=='bottom')t._addStatusBar(a,o);return ic},scriptaliciousLayout:function(s,a,o,p){var t=this,ed=t.editor,lo=s.theme_scriptalicious_toolbar_location,sl=s.theme_scriptalicious_statusbar_location,n,ic,etb,c;if(s.readonly){n=j.add(a,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'});return ic}if(lo=='top')t._addToolbars(a,o);if(lo=='external'){n=c=j.create('div',{style:'position:relative'});n=j.add(n,'div',{id:ed.id+'_external','class':'mceExternalToolbar'});j.add(n,'a',{id:ed.id+'_external_close',href:'javascript:;','class':'mceExternalClose'});n=j.add(n,'table',{id:ed.id+'_tblext',cellSpacing:0,cellPadding:0});etb=j.add(n,'tbody');if(p.firstChild.className=='mceOldBoxModel')p.firstChild.appendChild(c);else p.insertBefore(c,p.firstChild);t._addToolbars(etb,o);ed.onMouseUp.add(function(){var e=j.get(ed.id+'_external');j.show(e);j.hide(lastExtID);var f=Event.add(ed.id+'_external_close','click',function(){j.hide(ed.id+'_external');Event.remove(ed.id+'_external_close','click',f)});j.show(e);j.setStyle(e,'top',0-j.getRect(ed.id+'_tblext').h-1);j.hide(e);j.show(e);e.style.filter='';lastExtID=ed.id+'_external';e=null})}if(sl=='top')t._addStatusBar(a,o);if(!s.theme_scriptalicious_toolbar_container){n=j.add(a,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'})}if(lo=='bottom')t._addToolbars(a,o);if(sl=='bottom')t._addStatusBar(a,o);if(s.theme_scriptalicious_tabs_location=='bottom'){t._addTabs(p,o)}return ic},_sourceLayout:function(s,a,o,p){var t=this,ed=t.editor,lo=s.theme_scriptalicious_toolbar_location,sl=s.theme_scriptalicious_statusbar_location,n,ic,etb,c;var b=s.theme_scriptalicious_tabs_location;if(s.readonly){n=j.add(a,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'});return ic}if(!s.theme_scriptalicious_toolbar_container){n=j.add(a,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'})}if(sl=='bottom')t._addStatusBar(a,o);if(s.theme_scriptalicious_tabs_location=='bottom'){t._addTabs(p,o)}return ic},_rowLayout:function(s,b,o){var t=this,ed=t.editor,dc,da,cf=ed.controlManager,n,ic,to,a;dc=s.theme_scriptalicious_containers_default_class||'';da=s.theme_scriptalicious_containers_default_align||'center';each(explode(s.theme_scriptalicious_containers||''),function(c,i){var v=s['theme_scriptalicious_container_'+c]||'';switch(v.toLowerCase()){case'mceeditor':n=j.add(b,'tr');n=ic=j.add(n,'td',{'class':'mceIframeContainer'});break;case'mceelementpath':t._addStatusBar(b,o);break;default:a=(s['theme_scriptalicious_container_'+c+'_align']||da).toLowerCase();a='mce'+t._ufirst(a);n=j.add(j.add(b,'tr'),'td',{'class':'mceToolbar '+(s['theme_scriptalicious_container_'+c+'_class']||dc)+' '+a||da});to=cf.createToolbar("toolbar"+i);t._addControls(v,to);j.setHTML(n,to.renderHTML());o.deltaHeight-=s.theme_scriptalicious_row_height}});return ic},_addControls:function(v,a){var t=this,s=t.settings,di,cf=t.editor.controlManager;if(s.theme_scriptalicious_disable&&!t._disabled){di={};each(explode(s.theme_scriptalicious_disable),function(v){di[v]=1});t._disabled=di}else di=t._disabled;each(explode(v),function(n){var c;if(di&&di[n])return;if(n=='tablecontrols'){each(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(n){n=t.createControl(n,cf);if(n)a.add(n)});return}c=t.createControl(n,cf);if(c)a.add(c)})},_addTabs:function(c,o){var t=this,i,tb,ed=t.editor,s=t.settings,v,cf=ed.controlManager,di,n,h=[],a;var b;ed.onPostRender.add(function(){var a=j.get('mceTabsbar');c=j.get(ed.id+'_tbl');w=c.clientWidth;j.setStyle(a,'width',w+'px')});if(s.theme_scriptalicious_layout_mode=='source'){var d='off';var e='on'}else{var d='on';var e='off'}var f=j.get(ed.id);t.tabsbar=j.add(c,'div',{'class':'slTabsbar',id:'mceTabsbar'});t.tabsbar.style.padding='0px 3px';t.tabsbar.style.width=f.clientWidth+'px';t.oTabDesignLink=j.add(t.tabsbar,'a',{'href':'javascript:mceToggleEditor(\''+this.editor.id+'\',true);','id':t.tabd['id']+'_link','title':t.tabd['title'],style:{'color':'#fff','backgroundColor':'#fff'}});t.oTabSourceLink=j.add(t.tabsbar,'a',{'href':'javascript:mceToggleEditor(\''+this.editor.id+'\',false);','id':t.tabd['id']+'_link','title':t.tabd['title'],style:{'color':'#fff','backgroundColor':'#fff'}});t.oTabDesign=j.add(t.oTabDesignLink,'img',{'id':t.tabd['id'],'title':t.tabd['title'],'class':'slTabsbarTab','src':t.tabd['url'+d]});t.oTabSource=j.add(t.oTabSourceLink,'img',{'id':t.tabs['id'],'title':t.tabd['title'],'class':'slTabsbarTab','src':t.tabs['url'+e]});t.slTabsArea=j.add(t.tabsbar,'div',{'id':'slTabsArea','name':'slTabsArea','class':'slTabsArea'});t.slTabsMsg=j.add(t.slTabsArea,'span',{'id':'slTabsMsg','name':'slTabsMsg','class':'slTabsMsg'});t.slTabsSaveLink=j.add(t.slTabsArea,'a',{'id':'slTabsSaveLink','name':'slTabsSaveLink','href':'javascript:submitRichForm("kForm");',style:{'color':'#fff','backgroundColor':'#fff'}});t.slTabsSaveBtn=j.add(t.slTabsSaveLink,'img',{'id':'slTabsSaveBtn','name':'slTabsSaveBtn','class':'slTabsBtn','src':g.baseURL+'/themes/'+s.theme+'/skins/'+s.skin+'/img/sltabs_btn-save.gif'});t.slTabsPreviewLink=j.add(t.slTabsArea,'a',{'id':'slTabsPreviewLink','name':'slTabsPreviewLink','href':'javascript:mceUpdateContents();myWindowOpen("'+s.theme_scriptalicious_preview_file+'","Preview",1024,768);',style:{'color':'#fff','backgroundColor':'#fff'}});t.slTabsPreviewBtn=j.add(t.slTabsPreviewLink,'img',{'id':'slTabsPreviewBtn','name':'slTabsPreviewBtn','class':'slTabsBtn','src':g.baseURL+'/themes/'+s.theme+'/skins/'+s.skin+'/img/sltabs_btn-preview.gif'})},_switchTabs:function(){var t=this,s=t.settings;if(t.oTabDesign.src==t.tabd['urlon']){var a='off';var b='on'}else{var a='on';var b='off'}t.oTabDesign.src=t.tabd['url'+a];t.oTabSource.src=t.tabs['url'+b]},_addToolbars:function(c,o){var t=this,i,tb,ed=t.editor,s=t.settings,v,cf=ed.controlManager,di,n,h=[],a;a=s.theme_scriptalicious_toolbar_align.toLowerCase();a='mce'+t._ufirst(a);n=j.add(j.add(c,'tr'),'td',{'class':'mceToolbar '+a});if(!ed.getParam('accessibility_focus'))h.push(j.createHTML('a',{href:'#',onfocus:'tinyMCE.get(\''+ed.id+'\').focus();'},'<!-- IE -->'));h.push(j.createHTML('a',{href:'#',accesskey:'q',title:ed.getLang("scriptalicious.toolbar_focus")},'<!-- IE -->'));for(i=1;(v=s['theme_scriptalicious_buttons'+i]);i++){tb=cf.createToolbar("toolbar"+i,{'class':'mceToolbarRow'+i});if(s['theme_scriptalicious_buttons'+i+'_add'])v+=','+s['theme_scriptalicious_buttons'+i+'_add'];if(s['theme_scriptalicious_buttons'+i+'_add_before'])v=s['theme_scriptalicious_buttons'+i+'_add_before']+','+v;t._addControls(v,tb);h.push(tb.renderHTML());o.deltaHeight-=s.theme_scriptalicious_row_height}h.push(j.createHTML('a',{href:'#',accesskey:'z',title:ed.getLang("scriptalicious.toolbar_focus"),onfocus:'tinyMCE.getInstanceById(\''+ed.id+'\').focus();'},'<!-- IE -->'));j.setHTML(n,h.join(''))},_addStatusBar:function(d,o){var n,t=this,ed=t.editor,s=t.settings,r,mf,me,td;n=j.add(d,'tr');n=td=j.add(n,'td',{'class':'mceStatusbar'});n=j.add(n,'div',{id:ed.id+'_path_row'},s.theme_scriptalicious_path?ed.translate('scriptalicious.path')+': ':'&#160;');j.add(n,'a',{href:'#',accesskey:'x'});if(s.theme_scriptalicious_resizing){j.add(td,'a',{id:ed.id+'_resize',href:'javascript:;',onclick:"return false;",'class':'mceResize'});if(s.theme_scriptalicious_resizing_use_cookie){ed.onPostRender.add(function(){var o=Cookie.getHash("TinyMCE_"+ed.id+"_size"),c=j.get(ed.id+'_tbl');if(!o)return;if(s.theme_scriptalicious_resize_horizontal)c.style.width=Math.max(10,o.cw)+'px';c.style.height=Math.max(10,o.ch)+'px';j.get(ed.id+'_ifr').style.height=Math.max(10,parseInt(o.ch)+t.deltaHeight)+'px'})}ed.onPostRender.add(function(){Event.add(ed.id+'_resize','mousedown',function(e){var c,p,w,h,n,pa;c=j.get(ed.id+'_tbl');w=c.clientWidth;h=c.clientHeight;miw=s.theme_scriptalicious_resizing_min_width||100;mih=s.theme_scriptalicious_resizing_min_height||100;maw=s.theme_scriptalicious_resizing_max_width||0xFFFF;mah=s.theme_scriptalicious_resizing_max_height||0xFFFF;p=j.add(j.get(ed.id+'_parent'),'div',{'class':'mcePlaceHolder'});j.setStyles(p,{width:w,height:h});j.hide(c);j.show(p);r={x:e.screenX,y:e.screenY,w:w,h:h,dx:null,dy:null};mf=Event.add(j.doc,'mousemove',function(e){var w,h;r.dx=e.screenX-r.x;r.dy=e.screenY-r.y;w=Math.max(miw,r.w+r.dx);h=Math.max(mih,r.h+r.dy);w=Math.min(maw,w);h=Math.min(mah,h);if(s.theme_scriptalicious_resize_horizontal)p.style.width=w+'px';p.style.height=h+'px';return Event.cancel(e)});me=Event.add(j.doc,'mouseup',function(e){var a;Event.remove(j.doc,'mousemove',mf);Event.remove(j.doc,'mouseup',me);c.style.display='';j.remove(p);if(r.dx===null)return;a=j.get(ed.id+'_ifr');ifrs=j.get('frame_codemirror');if(ifrs){if(ifrs.style.display!='hidden'){ifrs.style.height=Math.max(10,ifrs.clientHeight+r.dy)+'px';a.style.height=Math.max(10,a.clientHeight+r.dy)+'px'}else{ifrs.style.height=Math.max(10,ifrs.clientHeight+r.dy)+'px'}}else{a.style.height=Math.max(10,a.clientHeight+r.dy)+'px'}if(s.theme_scriptalicious_resize_horizontal)c.style.width=Math.max(10,r.w+r.dx)+'px';c.style.height=Math.max(10,r.h+r.dy)+'px';var b=j.get('mceTabsbar');j.setStyle(b,'width',Math.max(10,r.w+r.dx)+'px');if(s.theme_scriptalicious_resizing_use_cookie){Cookie.setHash("TinyMCE_"+ed.id+"_size",{cw:r.w+r.dx,ch:r.h+r.dy})}});return Event.cancel(e)})})}o.deltaHeight-=21;n=d=null},_nodeChanged:function(b,d,n,e){var t=this,p,de=0,v,c,s=t.settings,cl,fz,fn;if(s.readonly)return;g.each(t.stateControls,function(c){d.setActive(c,b.queryCommandState(t.controls[c][1]))});d.setActive('visualaid',b.hasVisual);d.setDisabled('undo',!b.undoManager.hasUndo()&&!b.typing);d.setDisabled('redo',!b.undoManager.hasRedo());d.setDisabled('outdent',!b.queryCommandState('Outdent'));p=j.getParent(n,'A');if(c=d.get('link')){if(!p||!p.name){c.setDisabled(!p&&e);c.setActive(!!p)}}if(c=d.get('unlink')){c.setDisabled(!p&&e);c.setActive(!!p&&!p.name)}if(c=d.get('anchor')){c.setActive(!!p&&p.name);if(g.isWebKit){p=j.getParent(n,'IMG');c.setActive(!!p&&j.getAttrib(p,'mce_name')=='a')}}p=j.getParent(n,'IMG');if(c=d.get('image'))c.setActive(!!p&&n.className.indexOf('mceItem')==-1);if(c=d.get('styleselect')){if(n.className){t._importClasses();c.select(n.className)}else c.select()}if(c=d.get('formatselect')){p=j.getParent(n,j.isBlock);if(p)c.select(p.nodeName.toLowerCase())}if(b.settings.convert_fonts_to_spans){b.dom.getParent(n,function(n){if(n.nodeName==='SPAN'){if(!cl&&n.className)cl=n.className;if(!fz&&n.style.fontSize)fz=n.style.fontSize;if(!fn&&n.style.fontFamily)fn=n.style.fontFamily.replace(/[\"\']+/g,'').replace(/^([^,]+).*/,'$1').toLowerCase()}return false});if(c=d.get('fontselect')){c.select(function(v){return v.replace(/^([^,]+).*/,'$1').toLowerCase()==fn})}if(c=d.get('fontsizeselect')){c.select(function(v){if(v.fontSize&&v.fontSize===fz)return true;if(v['class']&&v['class']===cl)return true})}}else{if(c=d.get('fontselect'))c.select(b.queryCommandValue('FontName'));if(c=d.get('fontsizeselect')){v=b.queryCommandValue('FontSize');c.select(function(a){return a.fontSize==v})}}if(s.theme_scriptalicious_path&&s.theme_scriptalicious_statusbar_location){p=j.get(b.id+'_path')||j.add(b.id+'_path_row','span',{id:b.id+'_path'});j.setHTML(p,'');b.dom.getParent(n,function(n){var a=n.nodeName.toLowerCase(),u,pi,ti='';if(n.nodeType!=1||n.nodeName==='BR'||(j.hasClass(n,'mceItemHidden')||j.hasClass(n,'mceItemRemoved')))return;if(v=j.getAttrib(n,'mce_name'))a=v;if(g.isIE&&n.scopeName!=='HTML')a=n.scopeName+':'+a;a=a.replace(/mce\:/g,'');switch(a){case'b':a='strong';break;case'i':a='em';break;case'img':if(v=j.getAttrib(n,'src'))ti+='src: '+v+' ';break;case'a':if(v=j.getAttrib(n,'name')){ti+='name: '+v+' ';a+='#'+v}if(v=j.getAttrib(n,'href'))ti+='href: '+v+' ';break;case'font':if(s.convert_fonts_to_spans)a='span';if(v=j.getAttrib(n,'face'))ti+='font: '+v+' ';if(v=j.getAttrib(n,'size'))ti+='size: '+v+' ';if(v=j.getAttrib(n,'color'))ti+='color: '+v+' ';break;case'span':if(v=j.getAttrib(n,'style'))ti+='style: '+v+' ';break}if(v=j.getAttrib(n,'id'))ti+='id: '+v+' ';if(v=n.className){v=v.replace(/(webkit-[\w\-]+|Apple-[\w\-]+|mceItem\w+|mceVisualAid)/g,'');if(v&&v.indexOf('mceItem')==-1){ti+='class: '+v+' ';if(j.isBlock(n)||a=='img'||a=='span')a+='.'+v}}a=a.replace(/(html:)/g,'');a={name:a,node:n,title:ti};t.onResolveName.dispatch(t,a);ti=a.title;a=a.name;pi=j.create('a',{'href':"javascript:;",onmousedown:"return false;",title:ti,'class':'mcePath_'+(de++)},a);if(p.hasChildNodes()){p.insertBefore(j.doc.createTextNode(' \u00bb '),p.firstChild);p.insertBefore(pi,p.firstChild)}else p.appendChild(pi)},b.getBody())}},_sel:function(v){this.editor.execCommand('mceSelectNodeDepth',false,v)},_mceInsertAnchor:function(a,v){var b=this.editor;b.windowManager.open({url:g.baseURL+'/themes/scriptalicious/anchor.htm',width:320+parseInt(b.getLang('scriptalicious.anchor_delta_width',0)),height:90+parseInt(b.getLang('scriptalicious.anchor_delta_height',0)),inline:true},{theme_url:this.url})},_mceCharMap:function(){var a=this.editor;a.windowManager.open({url:g.baseURL+'/themes/scriptalicious/charmap.htm',width:550+parseInt(a.getLang('scriptalicious.charmap_delta_width',0)),height:250+parseInt(a.getLang('scriptalicious.charmap_delta_height',0)),inline:true},{theme_url:this.url})},_mceHelp:function(){var a=this.editor;a.windowManager.open({url:g.baseURL+'/themes/scriptalicious/about.htm',width:480,height:380,inline:true},{theme_url:this.url})},_mceColorPicker:function(u,v){var a=this.editor;v=v||{};a.windowManager.open({url:g.baseURL+'/themes/scriptalicious/color_picker.htm',width:375+parseInt(a.getLang('scriptalicious.colorpicker_delta_width',0)),height:250+parseInt(a.getLang('scriptalicious.colorpicker_delta_height',0)),close_previous:false,inline:true},{input_color:v.color,func:v.func,theme_url:this.url})},_mceCodeEditor:function(a,b){var c=this.editor;c.windowManager.open({url:g.baseURL+'/themes/scriptalicious/source_editor.htm',width:parseInt(c.getParam("theme_scriptalicious_source_editor_width",720)),height:parseInt(c.getParam("theme_scriptalicious_source_editor_height",580)),inline:true,resizable:true,maximizable:true},{theme_url:this.url})},_mceImage:function(a,b){var c=this.editor;if(c.dom.getAttrib(c.selection.getNode(),'class').indexOf('mceItem')!=-1)return;c.windowManager.open({url:g.baseURL+'/themes/scriptalicious/image.htm',width:355+parseInt(c.getLang('scriptalicious.image_delta_width',0)),height:275+parseInt(c.getLang('scriptalicious.image_delta_height',0)),inline:true},{theme_url:this.url})},_mceLink:function(a,b){var c=this.editor;c.windowManager.open({url:g.baseURL+'/themes/scriptalicious/link.htm',width:310+parseInt(c.getLang('scriptalicious.link_delta_width',0)),height:200+parseInt(c.getLang('scriptalicious.link_delta_height',0)),inline:true},{theme_url:this.url})},_mceNewDocument:function(){var a=this.editor;a.windowManager.confirm('scriptalicious.newdocument',function(s){if(s)a.execCommand('mceSetContent',false,'')})},_mceForeColor:function(){var t=this;this._mceColorPicker(0,{color:t.fgColor,func:function(a){t.fgColor=a;t.editor.execCommand('ForeColor',false,a)}})},_mceBackColor:function(){var t=this;this._mceColorPicker(0,{color:t.bgColor,func:function(a){t.bgColor=a;t.editor.execCommand('HiliteColor',false,a)}})},_ufirst:function(s){return s.substring(0,1).toUpperCase()+s.substring(1)}});g.ThemeManager.add('scriptalicious',g.themes.ScriptaliciousTheme)}(tinymce));